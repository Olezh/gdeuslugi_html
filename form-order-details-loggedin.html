<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Дополнение заказа - Авторизованный</title>
    <link rel="stylesheet" href="css/bootstrap-grid.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/main.js"></script>
</head>
<body>
<!--[if lt IE 10]>
    <p class="browserupgrade">Вы используете <b>устаревший</b> браузер. Пожалуйста, <a href="http://browsehappy.com/?locale=ru_ru">обновите свой браузер</a> чтобы улучшить опыт работы с сайтом.</p>
<![endif]-->

<header class="header-site">
        <div class="bx-action">
            <a href="#" class="back"><svg data-src="img/arrow-back.svg"></svg></a>
        </div><!-- /.bx-action -->
        <a href="#" class="logo">U</a>
        <div class="bx-user">
            <a href="#" class="userpic">
                А
            </a>
        </div><!-- /.bx-user -->
    </header>

<main class="container">
    <form action="#" class="form-order form-main" enctype="multipart/form-data" method="post">
        <h2 class="h-main">Дополните заказ</h2>

        <label class="form-row">
            <span class="lbl">Стоимость</span>
            <input type="text" placeholder="Укажите максимальный бюджет">            
        </label>     
        
        <label class="form-row">
            <span class="lbl">Выполнить до</span>
            <input type="date" placeholder="Укажите дату" date-format="dd/mm/yyyy">
        </label>

        <div class="form-row">
            <span class="lbl">Выберите фото</span>
            <div class="photos-uploaded">
                <!--                 
                <div class="item photo-uploaded">
                    <div class="photo"></div>
                    <a href="#" class="link">Удалить</a>
                </div> -->
                <div class="item item-add">
                    <div class="photo"></div>
                    <a href="#" class="link">Добавить</a>
                </div>
            </div><!-- /.photos-uploaded -->
        </div><!-- /.form-row -->
        <div class="img-file-inputs">
            <input type="file" class="img-input" name="user_file" style="display: none;">
        </div><!-- /.img-file-inputs -->
          

        <script>
            jQuery(document).ready(function($) {
                $('.item-add').on('click',function (e) {
                    e.preventDefault();
                    $('.img-input:first-child').click();
                });
    
                $('.img-input').on('change', function (e) {
                    showFile(e);
                });
            });

            function removeFile() {
                $('.photo-uploaded').find('.link').click(function(e){
                    e.preventDefault();
                    $(this).parents('.photo-uploaded').remove();
                });
            };                       

            function showFile(e) {
                var files = e.target.files;               

                for (var i = 0, f; f = files[i]; i++) {
                    if (!f.type.match('image.*')) continue;
                    var fr = new FileReader();
                    fr.onload = (function(theFile) {
                        return function(e) {
                            $("<div class='item photo-uploaded'><div class='photo' style='background-image:url(" + e.target.result + ")'></div><a href='#' class='link'>Удалить</a></div>")
                            .prependTo('.photos-uploaded');                            
                            removeFile();
                        };
                    })(f);
    
                    fr.readAsDataURL(f);
                }
            }
        </script>

        <button type="submit" class="btn btn-main btn-full-mb" disabled>Опубликовать</button>
    </form>
</main><!-- /.container -->

<div class="footer-placehodler"></div>

</body>
</html>